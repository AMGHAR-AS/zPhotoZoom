"use strict";Object.defineProperties(exports,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}});var e=Object.defineProperty,t=(t,n,o)=>((t,n,o)=>n in t?e(t,n,{enumerable:!0,configurable:!0,writable:!0,value:o}):t[n]=o)(t,n+"",o);function n(e,t,n,o){const i=t.width/t.height;let s,r;if(e.landscape)s=8*t.width/10,r=s/e.prop,r>t.height&&(r=9*t.height/10,s=r*e.prop);else if(i>=e.prop)r=9*t.height/10,s=r*e.prop;else{const n=e.prop-i;r=9*t.height/10-8*t.height/10*n,s=r*e.prop}let a=Math.min(s/e.width,r/e.height);return"number"!=typeof n||n<=0?a<(n=.3)&&(n=a):a<n&&(a=n),"number"!=typeof o||o<n?a>(o=5)&&(o=a,a=3):a>o&&(a=o),{width:s,height:r,x:(t.width-s)/2,y:(t.height-r)/2,scale:a,min:n,max:o}}function o(){const e=this,t=this._process;let n=!1,o=!1;for(let s=0;s<t.eventsClose.length;s++){if(t.eventsClose[s]({preventDefault:()=>{n=!0},stopPropagation:()=>{o=!0},target:t.currentImage.image.node,instance:e}),n)return;if(o)break}t.flags={isAnimated:!1,isMoved:!1,wheel:!1,movements:0,updateAttempt:!1,updated:!1,zoomIn:!1,loader:!1,stoped:t.flags.stoped};try{t.currentImage.image.evener.remove()}catch(i){}if(t.container)t.preview.container.removeChild(t.currentImage.imageNode),t.preview.evener(!0);else{(t.context.body||t.context.getElementsByTagName("body")[0]).removeChild(t.preview.container)}t.flags.loader&&(clearTimeout(t.flags.loader),t.flags.loader=!1),t.preview=!1,t.loader=!1}function i(e,t){const n=this._process;n.container||(n.loader&&(n.preview.container.removeChild(n.loader),n.flags.loader&&(clearTimeout(n.flags.loader),n.flags.loader=!1)),e?(n.loader=n.context.createElement("SPAN"),n.loader.innerText=" "+e):n.loader=n.context.createElement("ZLOADER"),n.loader.style.opacity="1",n.preview.container.appendChild(n.loader),t&&s.call(this,t))}function s(e){const t=this._process;t.loader&&(t.flags.loader&&clearTimeout(t.flags.loader),t.loader.style.transition="opacity "+e+"ms",t.flags.loader=setTimeout(()=>{t.preview&&t.preview.container.removeChild(t.loader),t.loader=!1,t.flags.loader=!1},e))}function r(){const e=this,t=this._process;let n,i,s,r=!1,a=!1;function l(e){0===e.button&&(a=!0,t.flags.isMoved||(r=!1))}function c(e){(t.flags.isMoved||a)&&(r=!0)}function h(n){const i=t.context.body||t.context.getElementsByTagName("body")[0];if((this===n.target||!i)&&!r&&a)try{o.call(e)}catch(s){}r=!1,a=!1,n.stopPropagation(),n.preventDefault()}return t.container?(i=t.container,s=t.context):(i=t.context.createElement("DIV"),i.setAttribute("class","ZPhotoZoom"),n=t.context.body||t.context.getElementsByTagName("body")[0],s=i),{container:i,apply:function(){n&&n.appendChild(i)},evener:function(e){e?(s.removeEventListener("mousedown",l),s.removeEventListener("mousemove",c),s.removeEventListener("mouseup",h)):setTimeout(function(){s.addEventListener("mousedown",l),s.addEventListener("mousemove",c),s.addEventListener("mouseup",h)},100)}}}function a(e){const t=this,o=this._process;let s,a=!1,c=!1;for(let n=0;n<o.eventsOpen.length;n++){if(o.eventsOpen[n]({preventDefault:()=>{a=!0},stopPropagation:()=>{c=!0},target:e.node,instance:t}),a)return;if(c)break}let h={};o.preview=r.call(t),e.loaded?(s=e.imageNode,o.preview.container.appendChild(s),h=n(e,l.call(t).nf,o.scaleLimit.min,o.scaleLimit.max),g.call(t,h.scale,{x:h.x/h.scale,y:h.y/h.scale})):i.call(t),o.preview.apply(),o.preview.evener();const u=l.call(t).nf;o.currentImage={image:e,imageNode:s,animate:!1,factor:h.scale,distanceFactor:1,scale:h.scale,origin:h,center:{x:u.cx,y:u.cy},minScale:h.min,maxScale:h.max,x:h.x,y:h.y,width:function(){return o.currentImage.imageNode.offsetWidth},height:function(){return o.currentImage.imageNode.offsetHeight}},e.loaded&&e.evener.apply()}function l(){const e=this._process.container;if(e){const t=this._process.container.getBoundingClientRect();return{container:e,nf:{width:t.width,height:t.height,top:t.top,left:t.left,cx:t.left+t.width/2,cy:t.top+t.height/2,x:0,y:0}}}return{container:null,nf:{width:window.innerWidth,height:window.innerHeight,top:0,left:0,cx:window.innerWidth/2,cy:window.innerHeight/2,x:0,y:0}}}function c(e){const t=this,n=this._process;let o=0,i=null,s=!1,r=!1,a=null;function c(e){let o=0,i=0;const s=n.context.documentElement.scrollTop||n.context.body.scrollTop,r=n.context.documentElement.scrollLeft||n.context.body.scrollLeft,a=l.call(t).nf;o=a.top+s,i=a.left+r;const c=[];for(let t=0;t<e.length;t++)c.push({x:e[t].pageX-i,y:e[t].pageY-o});return c}function p(e){if(!r){const n=(new Date).getTime();return n-a<320&&(d.call(t,i[0]),g(),e.stopPropagation(),e.preventDefault()),n}return 0}function g(e){a=e||null,s=!1}function f(){i=null,r=!1}function v(e){if("mousedown"===e.type){const t=e;0===t.button&&(s=!0,i=c([t]),e.stopPropagation(),e.preventDefault())}else if("touchstart"===e.type){const t=e;s=!0,o=t.touches.length,i=c(t.touches)}}function b(e){if(!s&&!i){let n=1;e.deltaY<0&&(n=-1),u.call(t,c([e])[0],n),e.stopPropagation(),e.preventDefault()}}function y(e){if(s)if(0===e.button){r=!0;const n=c([e]);i&&h.call(t,i[0],n[0]),i=n,e.stopPropagation(),e.preventDefault()}else g(a),f()}function x(e){if(o>0)if(i)if(1===o){r=!0;const n=c(e.touches);h.call(t,i[0],n[0]),i=n,e.stopPropagation(),e.preventDefault()}else o>=2&&(i.length<2?i=c(e.touches):(m.call(t,i,c(e.touches)),e.stopPropagation(),e.preventDefault()));else i=c(e.touches)}function I(e){0===e.button&&(s&&(a=p(e)),g(a),f())}function w(e){s?(1===o&&(a=p(e),f(),n.currentImage.distanceFactor=1),o=e.touches.length,0===o?(g(),f(),n.flags.movements=0,n.currentImage.distanceFactor=1):f()):(n.flags.movements=0,n.currentImage.distanceFactor=1,g(),f())}return{remove:function(){e.removeEventListener("wheel",b,{passive:!1}),e.removeEventListener("mousedown",v,{passive:!1}),e.removeEventListener("touchstart",v,{passive:!1}),e.removeEventListener("mousemove",y),e.removeEventListener("touchmove",x,{passive:!1}),n.context.removeEventListener("mouseup",I,{passive:!1,capture:!0}),n.context.removeEventListener("touchend",w,{passive:!1,capture:!0})},apply:function(){o=0,i=null,s=!1,r=!1,a=null,e.addEventListener("wheel",b,{passive:!1}),e.addEventListener("mousedown",v,{passive:!1}),e.addEventListener("touchstart",v,{passive:!1}),e.addEventListener("mousemove",y),e.addEventListener("touchmove",x,{passive:!1}),n.context.addEventListener("mouseup",I,{passive:!1,capture:!0}),n.context.addEventListener("touchend",w,{passive:!1,capture:!0})}}}function h(e,t){const n=this._process;n.flags.movements||n.flags.isAnimated||(n.flags.isMoved=!0,n.currentImage.x+=t.x-e.x,n.currentImage.y+=t.y-e.y,g.call(this,n.currentImage.factor,{x:n.currentImage.x/n.currentImage.factor,y:n.currentImage.y/n.currentImage.factor},!1))}function u(e,t){const n=this._process;if(n.flags.updateAttempt||n.flags.stoped)return;t>0?n.currentImage.scale-=.05:n.currentImage.scale+=.05;const o=n.currentImage.factor;n.currentImage.scale=Math.min(n.currentImage.maxScale,Math.max(n.currentImage.scale,n.currentImage.minScale)),n.currentImage.factor=n.currentImage.scale;const i=n.currentImage.imageNode.getBoundingClientRect(),s=l.call(this).nf;n.currentImage.x-=(n.currentImage.factor/o-1)*(e.x-i.left+s.left),n.currentImage.y-=(n.currentImage.factor/o-1)*(e.y-i.top+s.top),g.call(this,n.currentImage.factor,{x:n.currentImage.x/n.currentImage.factor,y:n.currentImage.y/n.currentImage.factor}),n.currentImage.center=e,n.flags.wheel=setTimeout(function(){n.flags.wheel=!1},600)}function d(e){const t=this._process;if(!(t.flags.isAnimated||t.flags.updateAttempt||t.flags.stoped))if(t.currentImage.scale<=t.currentImage.origin.scale){const n=t.currentImage.factor,o=t.currentImage.imageNode.getBoundingClientRect(),i=l.call(this).nf;t.currentImage.scale=Math.min(t.currentImage.maxScale,Math.max(t.currentImage.scale+2,t.currentImage.minScale)),t.currentImage.factor=t.currentImage.scale,t.currentImage.x-=(t.currentImage.factor/n-1)*(e.x-o.left+i.left),t.currentImage.y-=(t.currentImage.factor/n-1)*(e.y-o.top+i.top),t.currentImage.center=e,g.call(this,t.currentImage.factor,{x:t.currentImage.x/t.currentImage.factor,y:t.currentImage.y/t.currentImage.factor},!0)}else p.call(this)}function p(){const e=this._process;e.currentImage.scale=e.currentImage.origin.scale,e.currentImage.factor=e.currentImage.origin.scale,e.currentImage.x=e.currentImage.origin.x,e.currentImage.y=e.currentImage.origin.y,e.currentImage.minScale=e.currentImage.origin.min,e.currentImage.maxScale=e.currentImage.origin.max;const t=l.call(this).nf;e.currentImage.center={x:t.cx,y:t.cy},g.call(this,e.currentImage.factor,{x:e.currentImage.x/e.currentImage.factor,y:e.currentImage.y/e.currentImage.factor},!0)}function m(e,t){const n=this,o=this._process;if(o.flags.updateAttempt||o.flags.stoped)return;const i=o.currentImage.distanceFactor;o.currentImage.distanceFactor=function(e,t){function n(e,t){const n=e.x-t.x,o=e.y-t.y;return Math.sqrt(n*n+o*o)}return n(t[0],t[1])/n(e[0],e[1])}(e,t);const s=o.currentImage.distanceFactor/i;s<1?o.flags.zoomIn||(o.flags.zoomIn=!0):o.flags.zoomIn&&(o.flags.zoomIn=!1),o.currentImage.scale*=s;const r=function(e){if(1===e.length)return{x:e[0].x,y:e[0].y};{const t=Array.prototype.slice.call(e).map(e=>({x:e.x,y:e.y}));return{x:t.map(e=>e.x).reduce((e,t)=>e+t)/t.length,y:t.map(e=>e.y).reduce((e,t)=>e+t)/t.length}}}(t),a=o.currentImage.factor;o.currentImage.factor=Math.min(o.currentImage.maxScale,Math.max(o.currentImage.scale,o.currentImage.minScale));const c=o.currentImage.imageNode.getBoundingClientRect();if(o.flags.movements&&o.flags.movements>1){const e=l.call(n).nf;o.currentImage.x-=(o.currentImage.factor/a-1)*(r.x-c.left+e.left)-(r.x-o.currentImage.center.x),o.currentImage.y-=(o.currentImage.factor/a-1)*(r.y-c.top+e.top)-(r.y-o.currentImage.center.y),o.flags.updated||o.flags.isAnimated||(o.flags.updated=!0,setTimeout(function(){g.call(n,o.currentImage.factor,{x:o.currentImage.x/o.currentImage.factor,y:o.currentImage.y/o.currentImage.factor}),o.flags.updated=!1},0))}o.currentImage.center=r,o.flags.movements+=1}function g(e,t,n){const o=this._process;if(o.flags.isAnimated)return;o.flags.isAnimated=!0;let s=Math.round(100*e);s<100&&(s=" "+s),i.call(this,s+"%",800),setTimeout(function(){o.flags.isAnimated=!1;const i="scale3d("+e+","+e+",1) translate3d("+t.x+"px,"+t.y+"px,0px)",s="scale("+e+", "+e+") translate("+t.x+"px,"+t.y+"px)";o.currentImage.animate&&clearTimeout(o.currentImage.animate),n?o.currentImage.animate=setTimeout(function(){o.currentImage.imageNode.style.transition="",o.currentImage.animate=!1,o.flags.isMoved=!1},500):(o.currentImage.imageNode.style.transition="",o.currentImage.animate=setTimeout(function(){o.flags.isMoved=!1},100)),o.currentImage.imageNode.style.transformOrigin="top left",o.currentImage.imageNode.style.webkitTransformOrigin="top left",o.currentImage.imageNode.style.transform=i,o.currentImage.imageNode.style.webkitTransform=i,o.currentImage.imageNode.style.mozTransform=s,o.currentImage.imageNode.style.msTransform=s,o.currentImage.imageNode.style.oTransform=s})}function f(){const e=this,t=this._process,o=t.selector,i=t.context;function r(o){!function(e,t){const n=new Image;n.onload=function(){const e=this.height,n=this.width;t.call(this,n,e)},n.src=e}(o.src,function(i,r){o.imageNode=this,o.loaded=!0,o.width=i,o.height=r,o.prop=i/r,o.landscape=i>=r,o.evener=c.call(e,this),t.preview&&t.currentImage.image===o&&(t.currentImage.imageNode=this,t.preview.container.appendChild(t.currentImage.imageNode),t.currentImage.origin=n(o,l.call(e).nf,t.scaleLimit.min,t.scaleLimit.max),s.call(e,480),p.call(e),o.evener.apply())})}const a=[];let h=[];if(o&&"string"==typeof o&&i&&Node.DOCUMENT_NODE===i.nodeType)if(/\s+[^#]|>|\[|\.|,/.test(o))h=Array.from(i.querySelectorAll(o));else{const e=i.querySelector(o);e&&(h=[e])}if((Array.isArray(h)||h instanceof NodeList)&&h.length>0)for(let n=0;n<h.length;n++){const e=h[n],t={node:e,src:""};let o=!1;if("IMG"===e.tagName&&e.src)o=e.src;else{const t=getComputedStyle(e).backgroundImage;if(t)if(/^url\(/.test(t))try{const e=t.match(/url\(["']?([^"']*)["']?\)/);o=!!e&&e[1]}catch(u){o=!1}else o=!1}o&&(t.src=o,r(t),a.push(t))}return a}function v(e,t){const n=this;let o=!1,i=!1;function s(t){i||a.call(n,e),i=!1,o=!1}function r(){o=!0}function l(){o&&(i=!0)}t?(e.node.removeEventListener("click",s),e.node.removeEventListener("touchstart",r),e.node.removeEventListener("touchend",s),e.node.removeEventListener("touchmove",l)):(e.node.addEventListener("click",s),e.node.addEventListener("touchstart",r),e.node.addEventListener("touchend",s),e.node.addEventListener("touchmove",l))}function b(){const e=this._process;if(e.images=f.call(this),e.images.length>0)for(let t=0;t<e.images.length;t++)v.call(this,e.images[t])}function y(e,t){Object.defineProperty(this,"_process",{value:{preview:null,loader:null,eventsOpen:[],eventsClose:[],images:[],flags:{isAnimated:!1,isMoved:!1,wheel:!1,movements:0,updateAttempt:!1,updated:!1,zoomIn:!1,loader:!1,stoped:!1},container:e.container,scaleLimit:{min:e.min,max:e.max},selector:e.el,context:t||document,currentImage:null},configurable:!1,enumerable:!1,writable:!1})}function x(){const e=this,t=e._process;b.call(e),window.addEventListener("resize",function(){if(t.preview){const o=n(t.currentImage.image,l.call(e).nf,t.scaleLimit.min,t.scaleLimit.max);t.currentImage.origin=o,function n(){t.flags.updateAttempt=setTimeout(function(){t.flags.isAnimated?n():(p.call(e),t.flags.updateAttempt=!1)},70)}()}})}class I{constructor(e,n){if(t(this,"_process"),(()=>{if(document.getElementById("z-photo-zoom-styles"))return;const e=document.createElement("style");e.id="z-photo-zoom-styles",e.textContent="\n    .ZPhotoZoom {\n      position: fixed;\n      left: 0;\n      top: 0;\n      width: 100vw;\n      height: 100vh;\n      background-color: rgba(0, 0, 0, 0.7);\n      z-index: 999999999;\n      -webkit-user-select: none;\n      -moz-user-select: none;\n      -ms-user-select: none;\n      user-select: none;\n    }\n\n    .ZPhotoZoom img {\n      position: absolute;\n      cursor: grab;\n    }\n\n    .ZPhotoZoom img:active {\n      cursor: grabbing;\n    }\n\n    .ZPhotoZoom span {\n      color: white;\n      line-height: 30px;\n      font-weight: bold;\n      position: fixed;\n      top: calc(50vh - 25px);\n      left: calc(50vw - 15px);\n      background-color: rgba(114, 123, 135, 0.5);\n      width: 50px;\n      height: 30px;\n      display: inline-block;\n      vertical-align: middle;\n      border-radius: 5px;\n      text-align: center;\n    }\n\n    .ZPhotoZoom zloader {\n      position: fixed;\n      top: calc(50vh - 50px);\n      left: calc(50vw - 50px);\n      width: 40px;\n      height: 40px;\n      display: inline-block;\n      vertical-align: middle;\n      border-radius: 40px;\n      border: 6px solid rgba(114, 123, 135, 0.4);\n    }\n\n    .ZPhotoZoom zloader:after {\n      content: '';\n      position: absolute;\n      top: -6px;\n      left: -6px;\n      bottom: -6px;\n      right: -6px;\n      width: 40px;\n      height: 40px;\n      border-radius: 40px;\n      border: 6px solid transparent;\n      border-top-color: rgba(38, 38, 38, 0.27);\n      -webkit-animation: zPhotoZoomSpin 1s linear infinite;\n      animation: zPhotoZoomSpin 1s linear infinite;\n    }\n\n    @keyframes zPhotoZoomSpin {\n      0% {\n        -webkit-transform: rotate(0deg);\n        transform: rotate(0deg);\n      }\n      100% {\n        -webkit-transform: rotate(360deg);\n        transform: rotate(360deg);\n      }\n    }\n  ",document.head.appendChild(e)})(),!(this instanceof I))return console.error("zPhotoZoom is a class and can only be called with the keyword 'new'");e&&("object"==typeof e&&y.call(this,e,n),"string"==typeof e.el&&x.call(this))}stop(){this._process.flags.stoped=!0}resume(){this._process.flags.stoped=!1}reset(){this._process.preview&&p.call(this)}close(){this._process.preview&&o.call(this)}update(){const e=this._process;e.preview&&g.call(this,e.currentImage.factor,{x:e.currentImage.x/e.currentImage.factor,y:e.currentImage.y/e.currentImage.factor})}change(e){const t=this._process;if("string"==typeof e){t.preview&&o.call(this);for(let e=0;e<t.images.length;e++)v.call(this,t.images[e],!0);t.selector=e,t.images=[],b.call(this)}}onOpen(e,t){const n=this._process;if("function"==typeof e)if(t)for(let o=n.eventsOpen.length-1;o>=0;o--)n.eventsOpen[o]===e&&n.eventsOpen.splice(o,1);else n.eventsOpen.push(e)}onClose(e,t){const n=this._process;if("function"==typeof e)if(t)for(let o=n.eventsClose.length-1;o>=0;o--)n.eventsClose[o]===e&&n.eventsClose.splice(o,1);else n.eventsClose.push(e)}}var w=Object.defineProperty,z=(e,t,n)=>((e,t,n)=>t in e?w(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n)(e,"symbol"!=typeof t?t+"":t,n);const _={ArrowLeft:"previous",ArrowRight:"next",Escape:"close",Home:"first",End:"last",Space:"togglePlay"};class C{constructor(e){z(this,"options"),z(this,"enabled"),z(this,"boundHandler",null),this.options=e,this.enabled=e.enabled,this.enabled&&this.enable()}enable(){this.enabled&&this.boundHandler||(this.enabled=!0,this.boundHandler=this.handleKeyDown.bind(this),document.addEventListener("keydown",this.boundHandler))}disable(){this.enabled&&this.boundHandler&&(this.enabled=!1,document.removeEventListener("keydown",this.boundHandler),this.boundHandler=null)}destroy(){this.disable()}handleKeyDown(e){if(!this.enabled)return;const t=e.target;if("INPUT"===t.tagName||"TEXTAREA"===t.tagName||t.isContentEditable)return;const n=_[e.key];if(n)switch(e.preventDefault(),e.stopPropagation(),n){case"next":this.options.onNext();break;case"previous":this.options.onPrevious();break;case"close":this.options.onClose();break;case"first":this.options.onFirst();break;case"last":this.options.onLast();break;case"togglePlay":this.options.onTogglePlay&&this.options.onTogglePlay()}}}var E=Object.defineProperty,P=(e,t,n)=>((e,t,n)=>t in e?E(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n)(e,"symbol"!=typeof t?t+"":t,n);class S{constructor(e){if(P(this,"options"),P(this,"images"),P(this,"loadingQueue",new Set),P(this,"loadedIndices",new Set),this.options=e,this.images=e.images||[],!Array.isArray(this.images))return console.error("zPhotoCarousel: Preloader requires an array of images"),void(this.images=[]);this.options.preloadAll&&this.images.length>0&&this.preloadAll().catch(e=>{console.warn("zPhotoCarousel: Error preloading all images:",e)})}async preloadImage(e){if(e<0||e>=this.images.length)return Promise.reject(new Error(`Invalid index: ${e}`));const t=this.images[e];return t?t.loaded||this.loadedIndices.has(e)?Promise.resolve():this.loadingQueue.has(e)?this.waitForLoad(e):(this.loadingQueue.add(e),new Promise((n,o)=>{const i=new Image;i.onload=()=>{t.imageNode=i,t.loaded=!0,t.width=i.naturalWidth,t.height=i.naturalHeight,t.prop=i.naturalWidth/i.naturalHeight,t.landscape=i.naturalWidth>=i.naturalHeight,this.loadedIndices.add(e),this.loadingQueue.delete(e),n()},i.onerror=n=>{console.error(`zPhotoCarousel: Failed to load image at index ${e}:`,t.src),this.loadingQueue.delete(e),o(n)},i.src=t.src})):Promise.reject(new Error(`Image data not found at index: ${e}`))}async preloadAdjacent(e){if(!this.options.preloadAdjacent)return Promise.resolve();const t=this.images.length;if(0===t||e<0||e>=t)return Promise.resolve();const n=[],o=(e+1)%t,i=this.images[o];!i||i.loaded||this.loadedIndices.has(o)||n.push(o);const s=0===e?t-1:e-1,r=this.images[s];!r||r.loaded||this.loadedIndices.has(s)||n.push(s);try{await Promise.all(n.map(e=>this.preloadImage(e)))}catch(a){console.warn("zPhotoCarousel: Some adjacent images failed to preload",a)}}async preloadAll(){if(!this.options.preloadAll)return Promise.resolve();const e=[];for(let n=0;n<this.images.length;n++){const t=this.images[n];!t||t.loaded||this.loadedIndices.has(n)||e.push(n)}for(let n=0;n<e.length;n+=3){const o=e.slice(n,n+3);try{await Promise.all(o.map(e=>this.preloadImage(e)))}catch(t){console.warn("zPhotoCarousel: Some images failed to preload in batch",t)}}}waitForLoad(e){return new Promise(t=>{const n=setInterval(()=>{this.loadingQueue.has(e)||(clearInterval(n),t())},50);setTimeout(()=>{clearInterval(n),t()},1e4)})}getStats(){const e=this.images.length,t=this.loadedIndices.size;return{loaded:t,total:e,percentage:e>0?Math.round(t/e*100):0}}}var T=Object.defineProperty,A=(e,t,n)=>((e,t,n)=>t in e?T(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n)(e,"symbol"!=typeof t?t+"":t,n);class k{constructor(e){A(this,"options"),A(this,"element"),A(this,"startPoint",null),A(this,"enabled",!0),A(this,"boundTouchStart",null),A(this,"boundTouchMove",null),A(this,"boundTouchEnd",null),this.options=e,this.element=e.element,this.enable()}enable(){this.boundTouchStart||(this.enabled=!0,this.boundTouchStart=this.handleTouchStart.bind(this),this.boundTouchMove=this.handleTouchMove.bind(this),this.boundTouchEnd=this.handleTouchEnd.bind(this),this.element.addEventListener("touchstart",this.boundTouchStart,{passive:!0}),this.element.addEventListener("touchmove",this.boundTouchMove,{passive:!0}),this.element.addEventListener("touchend",this.boundTouchEnd,{passive:!0}))}disable(){this.boundTouchStart&&(this.enabled=!1,this.element.removeEventListener("touchstart",this.boundTouchStart),this.element.removeEventListener("touchmove",this.boundTouchMove),this.element.removeEventListener("touchend",this.boundTouchEnd),this.boundTouchStart=null,this.boundTouchMove=null,this.boundTouchEnd=null)}destroy(){this.disable()}handleTouchStart(e){if(this.enabled&&this.options.isEnabled())if(1===e.touches.length){const t=e.touches[0];t&&(this.startPoint={x:t.clientX,y:t.clientY,time:Date.now()})}else this.startPoint=null}handleTouchMove(e){this.enabled&&this.startPoint&&this.options.isEnabled()&&e.touches.length>1&&(this.startPoint=null)}handleTouchEnd(e){if(!this.enabled||!this.startPoint||!this.options.isEnabled())return void(this.startPoint=null);const t=e.changedTouches[0];if(!t)return void(this.startPoint=null);const n={x:t.clientX,y:t.clientY,time:Date.now()};this.detectSwipe(this.startPoint,n),this.startPoint=null}detectSwipe(e,t){const n=t.x-e.x,o=t.y-e.y,i=t.time-e.time,s=Math.abs(n);s<=Math.abs(o)||s<this.options.threshold||i>300||(n>0?this.options.onSwipeRight():this.options.onSwipeLeft())}}var N=Object.defineProperty,L=(e,t,n)=>((e,t,n)=>t in e?N(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n)(e,"symbol"!=typeof t?t+"":t,n);class O{constructor(e){L(this,"options"),L(this,"container",null),L(this,"track",null),L(this,"thumbnails",[]),L(this,"currentIndex"),this.options=e,this.currentIndex=e.currentIndex}render(){this.container=document.createElement("div"),this.container.className=`zpz-thumbnail-bar zpz-tb-${this.options.position}`,this.container.style.height=`${this.options.height}px`;const e=document.createElement("div");return e.className="zpz-tb-container",this.container.appendChild(e),this.track=document.createElement("div"),this.track.className="zpz-tb-track",e.appendChild(this.track),this.options.images.forEach((e,t)=>{const n=this.createThumbnail(e,t);this.thumbnails.push(n),this.track.appendChild(n)}),this.setActive(this.currentIndex),this.container}createThumbnail(e,t){const n=document.createElement("div");n.className="zpz-tb-item",n.setAttribute("data-index",t.toString()),n.setAttribute("role","button"),n.setAttribute("tabindex","0"),n.setAttribute("aria-label",`View image ${t+1}`);const o="top"===this.options.position||"bottom"===this.options.position,i=o?this.options.height-20:this.options.height;o?n.style.width=`${i}px`:n.style.height=`${i}px`;const s=document.createElement("img");return s.src=e.thumbnailSrc||e.src,s.alt=`Thumbnail ${t+1}`,s.draggable=!1,s.style.pointerEvents="none",n.appendChild(s),n.addEventListener("click",()=>{this.options.onThumbnailClick(t)}),n.addEventListener("keydown",e=>{"Enter"!==e.key&&" "!==e.key||(e.preventDefault(),this.options.onThumbnailClick(t))}),n}setActive(e){if(e<0||e>=this.thumbnails.length)return;if(this.currentIndex>=0&&this.currentIndex<this.thumbnails.length){const e=this.thumbnails[this.currentIndex];e&&(e.classList.remove("zpz-tb-active"),e.setAttribute("aria-selected","false"))}const t=this.thumbnails[e];t&&(t.classList.add("zpz-tb-active"),t.setAttribute("aria-selected","true")),this.currentIndex=e,this.scrollToActive()}scrollToActive(){if(!this.track||!this.container||this.currentIndex<0)return;const e=this.thumbnails[this.currentIndex];if(!e)return;"top"===this.options.position||"bottom"===this.options.position?this.scrollHorizontal(e):this.scrollVertical(e)}scrollHorizontal(e){const t=this.container.offsetWidth,n=e.offsetWidth,o=e.offsetLeft-t/2+n/2;this.track.style.transition="transform 0.3s ease",this.track.style.transform=`translateX(-${Math.max(0,o)}px)`}scrollVertical(e){const t=this.container.offsetHeight,n=e.offsetHeight,o=e.offsetTop-t/2+n/2;this.track.style.transition="transform 0.3s ease",this.track.style.transform=`translateY(-${Math.max(0,o)}px)`}update(e){this.track&&(this.track.innerHTML="",this.thumbnails=[],e.forEach((e,t)=>{const n=this.createThumbnail(e,t);this.thumbnails.push(n),this.track.appendChild(n)}),this.setActive(0))}destroy(){this.container&&this.container.parentNode&&this.container.parentNode.removeChild(this.container),this.container=null,this.track=null,this.thumbnails=[]}}var H=Object.defineProperty,M=(e,t,n)=>((e,t,n)=>t in e?H(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n)(e,"symbol"!=typeof t?t+"":t,n);class B{constructor(e,t,n="center"){this.onPrevious=e,this.onNext=t,this.position=n,M(this,"container",null),M(this,"prevButton",null),M(this,"nextButton",null)}render(){return this.container=document.createElement("div"),this.container.className=`zpz-nav-arrows zpz-arrows-${this.position}`,this.prevButton=this.createArrowButton("prev",this.onPrevious),this.container.appendChild(this.prevButton),this.nextButton=this.createArrowButton("next",this.onNext),this.container.appendChild(this.nextButton),this.container}createArrowButton(e,t){const n=document.createElement("button");n.className=`zpz-arrow zpz-arrow-${e}`,n.setAttribute("aria-label","prev"===e?"Previous image":"Next image"),n.type="button";const o=this.createArrowIcon(e);return n.appendChild(o),n.addEventListener("click",e=>{e.stopPropagation(),t()}),n}createArrowIcon(e){const t=document.createElementNS("http://www.w3.org/2000/svg","svg");t.setAttribute("width","24"),t.setAttribute("height","24"),t.setAttribute("viewBox","0 0 24 24"),t.setAttribute("fill","none"),t.setAttribute("stroke","currentColor"),t.setAttribute("stroke-width","2"),t.setAttribute("stroke-linecap","round"),t.setAttribute("stroke-linejoin","round");const n=document.createElementNS("http://www.w3.org/2000/svg","path");return"prev"===e?n.setAttribute("d","M15 18l-6-6 6-6"):n.setAttribute("d","M9 18l6-6-6-6"),t.appendChild(n),t}updateDisabledState(e,t,n){this.prevButton&&this.nextButton&&(n?(this.prevButton.disabled=!1,this.nextButton.disabled=!1):(this.prevButton.disabled=0===e,this.nextButton.disabled=e===t-1))}destroy(){this.container&&this.container.parentNode&&this.container.parentNode.removeChild(this.container),this.container=null,this.prevButton=null,this.nextButton=null}}var D=Object.defineProperty,j=(e,t,n)=>((e,t,n)=>t in e?D(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n)(e,"symbol"!=typeof t?t+"":t,n);class Z{constructor(e="top-right"){this.position=e,j(this,"container",null),j(this,"currentSpan",null),j(this,"totalSpan",null)}render(){this.container=document.createElement("div"),this.container.className=`zpz-counter zpz-counter-${this.position}`,this.container.setAttribute("aria-live","polite"),this.container.setAttribute("aria-atomic","true"),this.currentSpan=document.createElement("span"),this.currentSpan.className="zpz-counter-current",this.currentSpan.textContent="1";const e=document.createElement("span");return e.className="zpz-counter-separator",e.textContent="/",this.totalSpan=document.createElement("span"),this.totalSpan.className="zpz-counter-total",this.totalSpan.textContent="1",this.container.appendChild(this.currentSpan),this.container.appendChild(e),this.container.appendChild(this.totalSpan),this.container}update(e,t){this.currentSpan&&this.totalSpan&&(this.currentSpan.textContent=e.toString(),this.totalSpan.textContent=t.toString(),this.container&&this.container.setAttribute("aria-label",`Image ${e} of ${t}`))}destroy(){this.container&&this.container.parentNode&&this.container.parentNode.removeChild(this.container),this.container=null,this.currentSpan=null,this.totalSpan=null}}const $=async(e,t,n,o,i)=>new Promise((s,r)=>{if(e&&t&&i){!i.contains(e)&&e.parentNode&&console.warn("zPhotoCarousel: fromElement is not in the expected container");try{const r="forward"===n?"100%":"-100%",a="forward"===n?"-100%":"100%";t.style.position="absolute",t.style.top="0",t.style.left="0",t.style.width="100%",t.style.height="100%",t.style.transform=`translateX(${r})`,t.style.opacity="1",t.parentNode!==i&&i.appendChild(t),t.offsetHeight;const l="cubic-bezier(0.4, 0, 0.2, 1)";e.style.transition=`transform ${o}ms ${l}`,t.style.transition=`transform ${o}ms ${l}`,e.style.transform=`translateX(${a})`,t.style.transform="translateX(0)";const c=setTimeout(()=>{try{e.parentNode===i&&i.removeChild(e),e.style.transform="",e.style.transition="",e.style.position="",t.style.transition="",t.style.position="",s()}catch(n){console.error("zPhotoCarousel: Error during transition cleanup:",n),s()}},o);t.__transitionTimeoutId=c}catch(a){console.error("zPhotoCarousel: Error during slide transition:",a),r(a)}}else r(new Error("Transition requires valid fromElement, toElement, and container"))}),F={slide:$,fade:async(e,t,n,o,i)=>new Promise((n,s)=>{if(e&&t&&i){!i.contains(e)&&e.parentNode&&console.warn("zPhotoCarousel: fromElement is not in the expected container");try{t.style.position="absolute",t.style.top="0",t.style.left="0",t.style.width="100%",t.style.height="100%",t.style.opacity="0",t.parentNode!==i&&i.appendChild(t),t.offsetHeight,e.style.transition=`opacity ${o}ms ease`,t.style.transition=`opacity ${o}ms ease`,e.style.opacity="0",t.style.opacity="1";const s=setTimeout(()=>{try{e.parentNode===i&&i.removeChild(e),e.style.opacity="",e.style.transition="",e.style.position="",t.style.transition="",t.style.position="",n()}catch(o){console.error("zPhotoCarousel: Error during transition cleanup:",o),n()}},o);t.__transitionTimeoutId=s}catch(r){console.error("zPhotoCarousel: Error during fade transition:",r),s(r)}}else s(new Error("Transition requires valid fromElement, toElement, and container"))}),none:async(e,t,n,o,i)=>new Promise((n,o)=>{if(e&&t&&i)try{t.parentNode!==i&&i.appendChild(t),e.parentNode===i&&i.removeChild(e),n()}catch(s){console.error("zPhotoCarousel: Error during instant transition:",s),o(s)}else o(new Error("Transition requires valid fromElement, toElement, and container"))})};var R=Object.defineProperty,V=(e,t,n)=>((e,t,n)=>t in e?R(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n)(e,"symbol"!=typeof t?t+"":t,n);exports.default=I,exports.zPhotoCarousel=class extends I{constructor(e,t){(()=>{if(document.getElementById("z-photo-carousel-styles"))return;const e=document.createElement("style");e.id="z-photo-carousel-styles",e.textContent="\n    /* Carousel main container modifications */\n    .ZPhotoZoom.zpz-carousel-mode {\n      display: flex;\n      flex-direction: column;\n    }\n\n    .zpz-main-image-container {\n      position: relative;\n      flex: 1;\n      overflow: hidden;\n      display: flex;\n      align-items: center;\n      justify-content: center;\n    }\n\n    .zpz-main-image-container img {\n      position: absolute;\n      max-width: 100%;\n      max-height: 100%;\n    }\n\n    /* Navigation Arrows */\n    .zpz-nav-arrows {\n      position: absolute;\n      top: 0;\n      left: 0;\n      right: 0;\n      bottom: 0;\n      pointer-events: none;\n      z-index: 999;\n    }\n\n    .zpz-arrow {\n      pointer-events: auto;\n      position: absolute;\n      top: 50%;\n      transform: translateY(-50%);\n      background: rgba(0, 0, 0, 0.5);\n      backdrop-filter: blur(10px);\n      border: 2px solid rgba(255, 255, 255, 0.2);\n      width: 50px;\n      height: 50px;\n      border-radius: 50%;\n      cursor: pointer;\n      transition: all 0.3s ease;\n      display: flex;\n      align-items: center;\n      justify-content: center;\n      color: white;\n      outline: none;\n    }\n\n    .zpz-arrow:hover:not(:disabled) {\n      background: rgba(102, 126, 234, 0.8);\n      border-color: rgba(102, 126, 234, 1);\n      transform: translateY(-50%) scale(1.1);\n    }\n\n    .zpz-arrow:active:not(:disabled) {\n      transform: translateY(-50%) scale(0.95);\n    }\n\n    .zpz-arrow:disabled {\n      opacity: 0.3;\n      cursor: not-allowed;\n    }\n\n    .zpz-arrow:focus-visible {\n      outline: 2px solid #667eea;\n      outline-offset: 2px;\n    }\n\n    .zpz-arrow-prev {\n      left: 20px;\n    }\n\n    .zpz-arrow-next {\n      right: 20px;\n    }\n\n    .zpz-arrow svg {\n      width: 24px;\n      height: 24px;\n      fill: none;\n    }\n\n    /* Counter */\n    .zpz-counter {\n      position: absolute;\n      background: rgba(0, 0, 0, 0.7);\n      backdrop-filter: blur(10px);\n      padding: 8px 16px;\n      border-radius: 20px;\n      color: white;\n      font-size: 16px;\n      font-weight: 500;\n      z-index: 1000;\n      user-select: none;\n      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;\n    }\n\n    .zpz-counter-top-left {\n      top: 20px;\n      left: 20px;\n    }\n\n    .zpz-counter-top-right {\n      top: 20px;\n      right: 20px;\n    }\n\n    .zpz-counter-bottom-left {\n      bottom: 20px;\n      left: 20px;\n    }\n\n    .zpz-counter-bottom-right {\n      bottom: 20px;\n      right: 20px;\n    }\n\n    .zpz-counter-separator {\n      margin: 0 8px;\n      opacity: 0.6;\n    }\n\n    /* Thumbnail Bar */\n    .zpz-thumbnail-bar {\n      position: absolute;\n      background: rgba(0, 0, 0, 0.8);\n      backdrop-filter: blur(10px);\n      z-index: 1000;\n    }\n\n    .zpz-tb-bottom {\n      bottom: 0;\n      left: 0;\n      right: 0;\n    }\n\n    .zpz-tb-top {\n      top: 0;\n      left: 0;\n      right: 0;\n    }\n\n    .zpz-tb-left {\n      left: 0;\n      top: 0;\n      bottom: 0;\n    }\n\n    .zpz-tb-right {\n      right: 0;\n      top: 0;\n      bottom: 0;\n    }\n\n    .zpz-tb-container {\n      width: 100%;\n      height: 100%;\n      overflow: hidden;\n      padding: 10px;\n    }\n\n    .zpz-tb-track {\n      display: flex;\n      gap: 10px;\n      height: 100%;\n    }\n\n    .zpz-tb-bottom .zpz-tb-track,\n    .zpz-tb-top .zpz-tb-track {\n      flex-direction: row;\n    }\n\n    .zpz-tb-left .zpz-tb-track,\n    .zpz-tb-right .zpz-tb-track {\n      flex-direction: column;\n    }\n\n    .zpz-tb-item {\n      flex: 0 0 auto;\n      cursor: pointer;\n      border: 3px solid transparent;\n      border-radius: 5px;\n      overflow: hidden;\n      transition: all 0.3s ease;\n      background: rgba(255, 255, 255, 0.1);\n    }\n\n    .zpz-tb-item:hover {\n      border-color: rgba(255, 255, 255, 0.5);\n      transform: scale(1.05);\n    }\n\n    .zpz-tb-item:focus-visible {\n      outline: 2px solid #667eea;\n      outline-offset: 2px;\n    }\n\n    .zpz-tb-item.zpz-tb-active {\n      border-color: #667eea;\n      box-shadow: 0 0 10px rgba(102, 126, 234, 0.5);\n    }\n\n    .zpz-tb-item img {\n      width: 100%;\n      height: 100%;\n      object-fit: cover;\n      display: block;\n    }\n\n    /* Mobile responsive */\n    @media (max-width: 768px) {\n      .zpz-tb-bottom,\n      .zpz-tb-top {\n        height: 80px !important;\n      }\n\n      .zpz-arrow {\n        width: 40px;\n        height: 40px;\n      }\n\n      .zpz-arrow svg {\n        width: 20px;\n        height: 20px;\n      }\n\n      .zpz-arrow-prev {\n        left: 10px;\n      }\n\n      .zpz-arrow-next {\n        right: 10px;\n      }\n\n      .zpz-counter {\n        font-size: 14px;\n        padding: 6px 12px;\n      }\n    }\n  ",document.head.appendChild(e)})(),super(e,t),V(this,"_carouselState"),V(this,"_carouselOptions"),V(this,"_thumbnailBar"),V(this,"_keyboardNav"),V(this,"_preloader"),V(this,"_swipeDetector"),V(this,"_navigationArrows"),V(this,"_counter"),V(this,"_navigateCallbacks",[]),V(this,"_slideChangeCallbacks",[]),V(this,"_mainImageContainer"),V(this,"_clickHandlers",new Map),V(this,"_hoverHandlers",null),this._carouselOptions={...e,carousel:!1!==e.carousel,loop:!1!==e.loop,startIndex:e.startIndex||0,enableThumbnails:!1!==e.enableThumbnails,thumbnailHeight:e.thumbnailHeight||120,thumbnailPosition:e.thumbnailPosition||"bottom",thumbnailsVisible:e.thumbnailsVisible||5,enableKeyboard:!1!==e.enableKeyboard,enableArrows:!1!==e.enableArrows,arrowPosition:e.arrowPosition||"center",enableSwipe:!1!==e.enableSwipe,transition:e.transition||"slide",transitionDuration:e.transitionDuration||400,autoPlay:e.autoPlay||!1,autoPlayInterval:e.autoPlayInterval||3e3,pauseOnHover:!1!==e.pauseOnHover,preloadAdjacent:!1!==e.preloadAdjacent,preloadAll:e.preloadAll||!1,showCounter:!1!==e.showCounter,counterPosition:e.counterPosition||"top-right"},this._carouselState={currentIndex:this._carouselOptions.startIndex,totalImages:this.process.images.length,isPlaying:!1,playTimer:null,isTransitioning:!1,direction:null},this.initializeCarousel()}get process(){return this._process}initializeCarousel(){this._carouselOptions.carousel&&(this.process.images.forEach((e,t)=>{e.index=t}),(this._carouselOptions.preloadAdjacent||this._carouselOptions.preloadAll)&&(this._preloader=new S({images:this.process.images,preloadAdjacent:this._carouselOptions.preloadAdjacent,preloadAll:this._carouselOptions.preloadAll})),this.process.images.forEach((e,t)=>{e.evener&&e.evener.remove();const n=this._clickHandlers.get(e.node);n&&e.node.removeEventListener("click",n);const o=e=>{e.preventDefault(),e.stopPropagation(),this.openCarouselAt(t)};this._clickHandlers.set(e.node,o),e.node.addEventListener("click",o)}))}openCarouselAt(e){this._carouselState.currentIndex=e;const t=this.process.images[e];this.openCarouselViewer(t)}openCarouselViewer(e){let t=!1;for(let n=0;n<this.process.eventsOpen.length;n++){const o={preventDefault:()=>{t=!0},stopPropagation:()=>{},target:e.node,instance:this};if(this.process.eventsOpen[n](o),t)return}this.createCarouselStructure(),this.setupCarouselComponents(),this.displayImage(this._carouselState.currentIndex,!1),this._preloader&&this._preloader.preloadAdjacent(this._carouselState.currentIndex),this._carouselOptions.autoPlay&&this.play()}createCarouselStructure(){if(!this.process.preview){const e=this.getContainerPreview();this.process.preview=e,this.process.preview.apply()}const e=this.process.preview.container;e.classList.add("zpz-carousel-mode"),this._mainImageContainer=document.createElement("div"),this._mainImageContainer.className="zpz-main-image-container",e.appendChild(this._mainImageContainer)}setupCarouselComponents(){const e=this.process.preview.container;this._carouselOptions.enableArrows&&(this._navigationArrows=new B(()=>this.previous(),()=>this.next(),this._carouselOptions.arrowPosition),this._mainImageContainer.appendChild(this._navigationArrows.render()),this._navigationArrows.updateDisabledState(this._carouselState.currentIndex,this._carouselState.totalImages,this._carouselOptions.loop)),this._carouselOptions.showCounter&&(this._counter=new Z(this._carouselOptions.counterPosition),this._mainImageContainer.appendChild(this._counter.render()),this._counter.update(this._carouselState.currentIndex+1,this._carouselState.totalImages)),this._carouselOptions.enableThumbnails&&(this._thumbnailBar=new O({images:this.process.images,position:this._carouselOptions.thumbnailPosition,height:this._carouselOptions.thumbnailHeight,visibleCount:this._carouselOptions.thumbnailsVisible,currentIndex:this._carouselState.currentIndex,onThumbnailClick:e=>this.goTo(e)}),e.appendChild(this._thumbnailBar.render())),this._carouselOptions.enableKeyboard&&(this._keyboardNav=new C({onNext:()=>this.next(),onPrevious:()=>this.previous(),onClose:()=>this.close(),onFirst:()=>this.first(),onLast:()=>this.last(),onTogglePlay:()=>this.togglePlay(),enabled:!0})),this._carouselOptions.enableSwipe&&this._mainImageContainer&&(this._swipeDetector=new k({element:this._mainImageContainer,threshold:50,onSwipeLeft:()=>this.next(),onSwipeRight:()=>this.previous(),isEnabled:()=>this.process.currentImage?.scale===this.process.currentImage?.origin.scale})),this._carouselOptions.pauseOnHover&&this._carouselOptions.autoPlay&&this.setupPauseOnHover(e)}async displayImage(e,t=!0){const n=this.process.images[e];if(!n)return void console.error("zPhotoCarousel: Invalid image index:",e);!n.loaded&&this._preloader&&await this._preloader.preloadImage(e);const o=n.imageNode;if(!o)return void console.error("zPhotoCarousel: Image not loaded:",e);if(!this.process.currentImage||!t)return this._mainImageContainer.appendChild(o),void this.updateCurrentImage(n);const i=this.process.currentImage.imageNode,s=(r=this._carouselOptions.transition,F[r]||$);var r;const a=this._carouselState.direction||"forward";this._carouselState.isTransitioning=!0;try{await s(i,o,a,this._carouselOptions.transitionDuration,this._mainImageContainer)}catch(l){console.error("zPhotoCarousel: Transition error:",l)}finally{this._carouselState.isTransitioning=!1,this.updateCurrentImage(n)}}updateCurrentImage(e){this.process.currentImage={image:e,imageNode:e.imageNode,animate:!1,factor:1,distanceFactor:1,scale:1,origin:{},center:{x:0,y:0},minScale:this.process.scaleLimit.min,maxScale:this.process.scaleLimit.max,x:0,y:0,width:()=>e.imageNode.offsetWidth,height:()=>e.imageNode.offsetHeight}}next(){if(this._carouselState.isTransitioning)return;const e=this.getNextIndex();e!==this._carouselState.currentIndex&&this.navigateTo(e,"forward")}previous(){if(this._carouselState.isTransitioning)return;const e=this.getPreviousIndex();e!==this._carouselState.currentIndex&&this.navigateTo(e,"backward")}goTo(e){if(this._carouselState.isTransitioning||e<0||e>=this._carouselState.totalImages||e===this._carouselState.currentIndex)return;const t=e>this._carouselState.currentIndex?"forward":"backward";this.navigateTo(e,t)}first(){this.goTo(0)}last(){this.goTo(this._carouselState.totalImages-1)}async navigateTo(e,t){const n=this._carouselState.currentIndex,o=this.process.images[e];let i=!1;const s={from:n,to:e,direction:t,image:o,instance:this,preventDefault:()=>{i=!0},stopPropagation:()=>{}};for(const a of this._navigateCallbacks)if(a(s),i)return;this._carouselState.currentIndex=e,this._carouselState.direction=t,await this.displayImage(e,!0),this.updateUIComponents();const r={index:e,image:o,total:this._carouselState.totalImages,instance:this};for(const a of this._slideChangeCallbacks)a(r);this._preloader&&this._preloader.preloadAdjacent(e)}updateUIComponents(){const e=this._carouselState.currentIndex;this._counter&&this._counter.update(e+1,this._carouselState.totalImages),this._thumbnailBar&&this._thumbnailBar.setActive(e),this._navigationArrows&&this._navigationArrows.updateDisabledState(e,this._carouselState.totalImages,this._carouselOptions.loop)}getNextIndex(){const e=this._carouselState.currentIndex;return e===this._carouselState.totalImages-1?this._carouselOptions.loop?0:e:e+1}getPreviousIndex(){const e=this._carouselState.currentIndex,t=this._carouselState.totalImages;return 0===e?this._carouselOptions.loop?t-1:e:e-1}play(){this._carouselState.isPlaying||(this._carouselState.isPlaying=!0,this._carouselState.playTimer=setInterval(()=>{this.next()},this._carouselOptions.autoPlayInterval))}pause(){this._carouselState.isPlaying&&(this._carouselState.isPlaying=!1,this._carouselState.playTimer&&(clearInterval(this._carouselState.playTimer),this._carouselState.playTimer=null))}togglePlay(){this._carouselState.isPlaying?this.pause():this.play()}getCurrentIndex(){return this._carouselState.currentIndex}getTotalImages(){return this._carouselState.totalImages}getImages(){return this.process.images}isPlaying(){return this._carouselState.isPlaying}onNavigate(e,t){if("function"==typeof e)if(t){const t=this._navigateCallbacks.indexOf(e);t>-1&&this._navigateCallbacks.splice(t,1)}else this._navigateCallbacks.push(e)}onSlideChange(e,t){if("function"==typeof e)if(t){const t=this._slideChangeCallbacks.indexOf(e);t>-1&&this._slideChangeCallbacks.splice(t,1)}else this._slideChangeCallbacks.push(e)}setupPauseOnHover(e){let t=!1;const n=()=>{this._carouselState.isPlaying?(t=!1,this.pause()):t=!0},o=()=>{!t&&this._carouselOptions.autoPlay&&this.play()};this._hoverHandlers={mouseenter:n,mouseleave:o},e.addEventListener("mouseenter",n),e.addEventListener("mouseleave",o)}cleanupPauseOnHover(){if(!this._hoverHandlers)return;const e=this.process.preview?.container;e&&(e.removeEventListener("mouseenter",this._hoverHandlers.mouseenter),e.removeEventListener("mouseleave",this._hoverHandlers.mouseleave)),this._hoverHandlers=null}close(){this.pause(),this._thumbnailBar?.destroy(),this._keyboardNav?.destroy(),this._swipeDetector?.destroy(),this._navigationArrows?.destroy(),this._counter?.destroy(),this.cleanupClickHandlers(),this.cleanupPauseOnHover(),super.close()}cleanupClickHandlers(){this._clickHandlers.forEach((e,t)=>{t.removeEventListener("click",e)}),this._clickHandlers.clear(),this.process.images.forEach(e=>{e.evener&&e.evener.apply()})}getContainerPreview(){const e=this,t=this.process;let n,o,i,s=!1,r=!1;function a(e){0===e.button&&(r=!0,t.flags.isMoved||(s=!1))}function l(e){(t.flags.isMoved||r)&&(s=!0)}function c(n){const o=t.context.body||t.context.getElementsByTagName("body")[0];if((this===n.target||!o)&&!s&&r)try{e.close()}catch(i){}s=!1,r=!1,n.stopPropagation(),n.preventDefault()}return t.container?(o=t.container,i=t.context):(o=t.context.createElement("DIV"),o.setAttribute("class","ZPhotoZoom"),n=t.context.body||t.context.getElementsByTagName("body")[0],i=o),{container:o,apply:function(){n&&n.appendChild(o)},evener:function(e){e?(i.removeEventListener("mousedown",a),i.removeEventListener("mousemove",l),i.removeEventListener("mouseup",c)):setTimeout(function(){i.addEventListener("mousedown",a),i.addEventListener("mousemove",l),i.addEventListener("mouseup",c)},100)}}}},exports.zPhotoZoom=I;
//# sourceMappingURL=zphotozoom.cjs.js.map
